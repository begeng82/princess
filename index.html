<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Galaxy Love Hand FX</title>
<style>
body{
  margin:0;
  overflow:hidden;
  background:black;
  font-family:Arial;
}
video{
  position:fixed;
  top:10px;
  right:10px;
  width:160px;
  border-radius:10px;
  opacity:0.8;
  z-index:10;
}
canvas{
  position:absolute;
  top:0;left:0;
}
#text{
  position:absolute;
  color:#ff66ff;
  font-size:28px;
  text-shadow:0 0 20px hotpink;
  pointer-events:none;
}
.particle{
  position:absolute;
  width:6px;
  height:6px;
  border-radius:50%;
  animation:burst 1.2s linear forwards;
}
@keyframes burst{
  from{opacity:1;}
  to{opacity:0;transform:translate(var(--x),var(--y)) scale(0);}
}
.heart{
  position:absolute;
  font-size:22px;
  animation:float 2s linear forwards;
}
@keyframes float{
  from{opacity:1;}
  to{transform:translateY(-200px);opacity:0;}
}
</style>
</head>
<body>

<video id="video" autoplay playsinline></video>
<canvas id="canvas"></canvas>
<div id="text">Show your hand âœ‹</div>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<script>
const video=document.getElementById("video");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const text=document.getElementById("text");

canvas.width=window.innerWidth;
canvas.height=window.innerHeight;

// ===== HANDS =====
const hands=new Hands({
  locateFile:file=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
});
hands.setOptions({
  maxNumHands:1,
  modelComplexity:0,
  minDetectionConfidence:0.5,
  minTrackingConfidence:0.5
});

// ===== CAMERA =====
const camera=new Camera(video,{
  onFrame:async()=>{await hands.send({image:video});},
  width:640,
  height:480
});
camera.start();

// ===== GALAXY =====
let stars=[];
let speed=0.004;
let lastGesture="";

function createGalaxy(){
  stars=[];
  for(let i=0;i<900;i++){
    stars.push({
      angle:Math.random()*Math.PI*2,
      radius:Math.random()*250,
      spin:Math.random()*0.003+0.001,
      color:`hsl(${Math.random()*360},100%,70%)`
    });
  }
}
createGalaxy();

function drawGalaxy(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  let cx=canvas.width/2;
  let cy=canvas.height/2;

  stars.forEach(s=>{
    s.angle+=s.spin+speed;
    let x=cx+Math.cos(s.angle)*s.radius;
    let y=cy+Math.sin(s.angle)*s.radius;
    ctx.fillStyle=s.color;
    ctx.fillRect(x,y,2,2);
  });

  requestAnimationFrame(drawGalaxy);
}
drawGalaxy();

// ===== HAND RESULT =====
hands.onResults(results=>{
  if(results.multiHandLandmarks){
    detectGesture(results.multiHandLandmarks[0]);
  }
});

// ===== GESTURE =====
function isUp(lm,tip,pip){
  return lm[tip].y < lm[pip].y;
}

function detectGesture(lm){
  let index=isUp(lm,8,6);
  let middle=isUp(lm,12,10);
  let ring=isUp(lm,16,14);
  let pinky=isUp(lm,20,18);

  let gesture="";
  if(index && !middle && !ring && !pinky) gesture="POINT";
  else if(index && middle && !ring && !pinky) gesture="PEACE";
  else if(index && middle && ring && pinky) gesture="OPEN";
  else if(!index && !middle && !ring && !pinky) gesture="FIST";
  else gesture="OTHER";

  // posisi text ikut jari telunjuk
  let x = lm[8].x * window.innerWidth;
  let y = lm[8].y * window.innerHeight;
  text.style.left = x+"px";
  text.style.top = y+"px";

  if(gesture!==lastGesture){
    burstParticles(x,y);
    lastGesture=gesture;
  }

  if(gesture==="POINT"){
    text.innerText="I Love You MIESHELLA ðŸ’•";
    spawnHearts();
  }
  else if(gesture==="OPEN"){
    speed=0.01;
    text.innerText="Galaxy Speed ðŸš€";
  }
  else if(gesture==="FIST"){
    speed=0.001;
    text.innerText="Galaxy Calm ðŸŒŒ";
  }
  else if(gesture==="PEACE"){
    createGalaxy();
    text.innerText="New Galaxy âœ¨";
  }
  else{
    text.innerText="Show your hand âœ‹";
  }
}

// ===== EFFECTS =====
function burstParticles(x,y){
  for(let i=0;i<30;i++){
    const p=document.createElement("div");
    p.className="particle";
    p.style.left=x+"px";
    p.style.top=y+"px";
    p.style.background=`hsl(${Math.random()*360},100%,70%)`;
    p.style.setProperty("--x",(Math.random()-0.5)*300+"px");
    p.style.setProperty("--y",(Math.random()-0.5)*300+"px");
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),1200);
  }
}

function spawnHearts(){
  for(let i=0;i<5;i++){
    const h=document.createElement("div");
    h.className="heart";
    h.innerHTML="ðŸ’–";
    h.style.left=Math.random()*window.innerWidth+"px";
    h.style.top=window.innerHeight+"px";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),2000);
  }
}

window.addEventListener("resize",()=>{
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
});
</script>

</body>
</html>
