<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hand Tracking Full</title>
  <style>
    body {
      margin: 0;
      background: black;
      text-align: center;
      color: white;
      font-family: Arial;
    }
    video, canvas {
      position: absolute;
      left: 0;
      top: 0;
    }
    #gesture {
      position: fixed;
      bottom: 20px;
      width: 100%;
      font-size: 30px;
      font-weight: bold;
      color: lime;
    }
  </style>
</head>
<body>

<video id="video" autoplay playsinline></video>
<canvas id="canvas"></canvas>
<div id="gesture">Loading...</div>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const gestureText = document.getElementById("gesture");

canvas.width = 640;
canvas.height = 480;
video.width = 640;
video.height = 480;

const hands = new Hands({
  locateFile: (file) => {
    return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`;
  }
});

hands.setOptions({
  maxNumHands: 1,
  modelComplexity: 1,
  minDetectionConfidence: 0.7,
  minTrackingConfidence: 0.7
});

hands.onResults(results => {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(results.image,0,0,canvas.width,canvas.height);

  if(results.multiHandLandmarks){
    for(const landmarks of results.multiHandLandmarks){
      drawConnectors(ctx, landmarks, HAND_CONNECTIONS, {color:'#00FF00', lineWidth:3});
      drawLandmarks(ctx, landmarks, {color:'#FF0000', lineWidth:2});
      detectGesture(landmarks);
    }
  } else {
    gestureText.innerText = "No hand detected";
  }
});

const camera = new Camera(video,{
  onFrame: async ()=>{
    await hands.send({image: video});
  },
  width:640,
  height:480
});

camera.start();

function detectGesture(lm){
  let thumb = lm[4].y < lm[3].y;
  let index = lm[8].y < lm[6].y;
  let middle = lm[12].y < lm[10].y;
  let ring = lm[16].y < lm[14].y;
  let pinky = lm[20].y < lm[18].y;

  let gesture = "Unknown";

  if(index && middle && ring && pinky && thumb){
    gesture = "âœ‹ Open Hand";
  }
  else if(!index && !middle && !ring && !pinky){
    gesture = "âœŠ Fist";
  }
  else if(thumb && !index && !middle && !ring && !pinky){
    gesture = "ðŸ‘ Thumbs Up";
  }
  else if(index && middle && !ring && !pinky){
    gesture = "âœŒ Peace";
  }
  else if(thumb && index && !middle && !ring && !pinky){
    gesture = "ðŸ‘Œ OK";
  }

  gestureText.innerText = "Gesture: " + gesture;
}
</script>

</body>
</html>
